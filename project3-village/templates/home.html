{% extends "base.html" %}

{% block title %}{{ target_user.username }}'s Home | The Village{% endblock %}

{% block content %}
<div class="home-container">

    <div class="home-frame">
        <!-- background -->
        <img src="{{ url_for('static', filename='images/home_bg.png') }}" alt="Home background" class="home-bg">

        <!-- furniture -->
        {% for category in ['chair', 'plant', 'sofa', 'table', 'wallart'] %}
            {% set equipped_id = target_user.furniture.get(category) %}
            {% set ns = namespace(src=none) %}
            {% if catalog and category in catalog %}
                {% for item in catalog[category] %}
                    {% if item.id == equipped_id %}
                        {% set ns.src = item.src %}
                    {% endif %}
                {% endfor %}
            {% endif %}
            <img id="furniture-{{ category }}" class="furniture" 
                style="{% if not ns.src %}display:none;{% endif %}"
                src="{{ url_for('static', filename='images/' + ns.src) if ns.src else '' }}" 
                alt="{{ category|title }}">
        {% endfor %}

        {% if is_owner %}
        <img id="edit-gear" src="{{ url_for('static', filename='images/gear.png') }}" alt="Edit Shop" class="edit-gear">
        {% endif %}

    </div>
    
    {% if is_owner %}
    <div id="edit-drawer" class="hidden">
        <div class="drawer-header">
            <h3>Shop</h3>
            <button id="close-drawer">âœ•</button>
        </div>
        <div class="drawer-content" id="shop-content">
            <!-- will be added by js -->
        </div>
    </div>
    {% endif %}
</div>

<link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
{% if is_owner %}
<script src="{{ url_for('static', filename='js/home.js') }}"></script>
{% endif %}
{% endblock %}